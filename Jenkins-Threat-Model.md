# Jenkins Threat Model - Preliminary

In a nutshell, Jenkins is the leading open-source automation server. Built with Java, it provides over 1,800 plugins to support automating virtually anything, so that humans can spend their time doing things machines cannot.

## [What to Use Jenkins for and When to Use It](Jenkins-Threat-Model.md#what-to-use-jenkins-for-and-when-to-use-it)

Use Jenkins to automate your development workflow, so you can focus on work that matters most. Jenkins is commonly used for:

* Building projects
* Running tests to detect bugs and other issues as soon as they are introduced
* Static code analysis
* Deployment

Execute repetitive tasks, save time, and optimize your development process with Jenkins.

## [Threat Model](Jenkins-Threat-Model.md#threat-model)

![image](https://github.com/demonoidvk/Vulnerability-Assessment-Reports/assets/18901770/b28e7aab-763d-4f71-8a55-9074d39edeee)

### Components

|                                                |
| ---------------------------------------------- |
| Deployement servers 1, 2                       |
| Jenkins Server                                 |
| Internal User (with Read/Write/Execute Access) |
| External User (with Read-only Access)          |
| Command/Config Data Store                      |
| ### Functions                                  |

|                                                                                                                        |
| ---------------------------------------------------------------------------------------------------------------------- |
| **Authentication Data**: Provided by the different types of users to Jenkins Server, where server checks in data store |
| **Read-Only Authentication Confirmation**: Provided to users, accessing from outside the Internal Trust Boundary       |
| **Authentication Confirmation:** Provided to internal users, with complete access                                      |
| **Status Check for deployment**: Check status of Deployment servers                                                    |
| **Status**: Result of deployment check/commands run                                                                    |
| **Deployment Commands**: Jenkins Runs Command on the Deployment server, using SSH                                      |
| **Get Configuration/ Commands**: Jenkins queries the stored config/commands                                            |
| **Result**: Output of the Jenkins query, catered by Data store                                                         |
| **SSH (run commands)**: Jenkins Server takes ssh connection onto deployment servers and runs commands                  |

### Technologies used:

|                                                                                                |
| ---------------------------------------------------------------------------------------------- |
| Java (version 8)                                                                               |
| Firewall (FortiGate)                                                                           |
| Linux Server (Ubuntu 20.04)                                                                    |
| Configuration Database like MySQL, H2                                                          |
| UI for Jenkins Server: running with Jetty server                                               |
| Network Protocol used: SSH, VPN tunnel through firewall, HTTPS(For browser based access to UI) |

### Tests done during Security Profiling

|                          |                                                                                                                                                                                                                                                                                                                                                    |
| ------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Input validation         | <p>·         Are commands passed by external user, validated?<br><br>·         Commands passed by internal user, validated?<br><br>·         Username/Passwords, validation to check if it’s not a Query Attack</p>                                                                                                                                |
| Authentication           | <p>·         Are credentials secured if they are passed over the network like via VPN?<br><br>·         Are strong account policies used?<br><br>·         Are strong passwords enforced?<br><br>·         Are password verifiers (using one-way hashes) used for user passwords?</p>                                                              |
| VPN Authentication       | <p>·         What are security policies at Firewall level?<br><br>·         Is the Firewall updated with latest threat information constantly?</p>                                                                                                                                                                                                 |
| Configuration management | <p>·         How is remote administration secured?<br><br>·         What configuration stores are used and how are they secured?<br><br>·         Is the data store storing, authentication information and other information at same auth level?<br><br>·         If so, how is authentication information secured?</p>                           |
| Session management       | <p>·         How are session cookies generated?<br><br>·         How are they secured to prevent session hijacking?<br><br>·         How are commands provided by user monitored?<br><br>·         How is session state secured as it crosses the network?<br><br>·         When session is created by Jenkins server, is it visible to users?</p> |
| Result Validation        | ·         Is the output (like status, result) validated, to not output any sensitive information?                                                                                                                                                                                                                                                  |
| Exception management     | <p>·         How does the application handle error conditions?<br><br>·         Are exceptions ever allowed to propagate back to the client?</p>                                                                                                                                                                                                   |
| Auditing and logging     | <p>·         Does the application audit on all servers?<br><br>·         Are there audits available for all the vpn access and Authentication requests?<br><br>·         How are log files secured?<br><br>·         Can the log files be edited by users? Or only by the application?</p>                                                         |

### Possible Attacks

|                                                               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| ·         DDoS Attack Pattern                                 | <p><strong>Goal:</strong> Disrupt service/Functioning of the service<br><br><strong>Precondition:</strong> Attacker executes multiple requests on the server<br><br><strong>Attack:</strong><br><br><em><strong>AND</strong></em>       1. Identifies whether the server is susceptible to DDoS type of attacks.<br><br>2. Identify how horizontally scalable the server is.<br><br>3. Define what aspect of server to attack from following:<br><br>·       bandwidth overload<br><br>·       system resource overload<br><br>·       exploitation of software errors and security gaps<br><br>4. Create chain of parallel requesting servers<br><br>5. Execute the attacks<br><br><strong>Postcondition:</strong> Target system’s services or performance is disrupted</p> |
| ·         Buffer overflow attack                              | <p><strong>Goal</strong>: Exploit buffer overflow vulnerability to perform malicious function on<br><br>target system<br><br><strong>Precondition</strong>: The adversary identifies the program/process in Jenkins server to perform the buffer overflow on.<br><br><strong>Attack:</strong><br><br><strong>AND</strong><br><br>·       Provide large input to a program and observe the behavior. If there is a crash, this means that a buffer overflow attack is possible.<br><br>·       The adversary crafts the content to be injected.<br><br>·       Execute the attacks<br><br><strong>Postcondition:</strong> the adversary injects the crafted overflow content into the buffer.</p>                                                                             |
| ·         SQL injection                                       | <p><strong>Goal</strong>: Exploit SQL db/ data-stores queries run by the Jenkins server, to get more privileged information<br><br><strong>Precondition</strong>: The adversary identifies way data is being queried and what technology is being used.<br><br><strong>Attack:</strong><br><br><strong>AND</strong><br><br>·       Craft a sql query or part of it, that can run two parts in single input.<br><br>·       Input the query into the input box<br><br>·       Execute<br><br><strong>Postcondition:</strong> The adversary runs sql query on the db of the data-store.</p>                                                                                                                                                                                    |
| ·         Privilege Escalation through improper authorization | <p><strong>Goal</strong>: Privilege Escalation through improper authorization<br><br><strong>Precondition</strong>: The adversary identifies way to manipulate server, in giving him the administrator access<br><br><strong>Attack:</strong><br><br><strong>AND</strong><br><br>·       Craft the exploit<br><br>·       Execute<br><br><strong>Postcondition:</strong> The adversary gets administrative access to the server.</p>                                                                                                                                                                                                                                                                                                                                         |
| ·         Session Sniffing                                    | <p><strong>Goal</strong>: to exploit the web session control mechanism<br><br><strong>Precondition</strong>: The web session, needs to be token based<br><br><strong>Attack:</strong><br><br><strong>AND</strong><br><br><br>·       attacker uses a sniffer to capture a valid token session<br><br>·       they use the valid token session to gain unauthorized access to the Web Server<br><br>Postcondition: The adversary gets unauthorized access to the server.</p>                                                                                                                                                                                                                                                                                                  |

### Threat Prioritization

|                        |                                                                                                                                 |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| **Threat Description** | **Attacker gets remote-code execution option, through buffer overflow attack**                                                  |
| Threat target          | Web applications                                                                                                                |
| Risk                   | High                                                                                                                            |
| Attack techniques      | Use of extremely large inputs                                                                                                   |
| Countermeasures        | Validate all inputs                                                                                                             |
| **Threat Description** | **Attacker gets administrative access, through improper security configuration**                                                |
| Threat target          | Web applications                                                                                                                |
| Risk                   | High                                                                                                                            |
| Attack techniques      | Exploits                                                                                                                        |
| Countermeasures        | Validate all configurations frequently, and provide no configuration to be updated via user-input that allow mis-configurations |
| **Threat Description** | **Attacker accesses the server with some other users session**                                                                  |
| Threat target          | Other users’ session                                                                                                            |
| Risk                   | Medium                                                                                                                          |
| Attack techniques      | MITM                                                                                                                            |
| Countermeasures        | Provide all network-based connections via SSL tunnel                                                                            |
| **Threat Description** | **View Sensitive information without any authorization**                                                                        |
| Threat target          | Data stores                                                                                                                     |
| Risk                   | Medium                                                                                                                          |
| Attack techniques      | SQL injection                                                                                                                   |
| Countermeasures        | Validate all inputs                                                                                                             |
| **Threat Description** | **Service disruption**                                                                                                          |
| Threat target          | Web Servers                                                                                                                     |
| Risk                   | Low                                                                                                                             |
| Attack techniques      | DDoS                                                                                                                            |
| Countermeasures        | Request validation                                                                                                              |
